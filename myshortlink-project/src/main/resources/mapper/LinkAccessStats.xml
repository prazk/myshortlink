<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.prazk.myshortlink.project.mapper.LinkAccessStatsMapper">


    <insert id="recordBasicAccessStats">
        INSERT INTO
            t_link_access_stats (short_uri, pv, uv, uip, access_date, access_hour, access_weekday, create_time, update_time, del_flag)
        VALUES (#{et.shortUri}, 1, 1, 1, #{et.accessDate}, #{et.accessHour}, #{et.accessWeekday}, #{et.createTime}, #{et.updateTime}, #{et.delFlag})
        ON DUPLICATE KEY UPDATE
             pv = pv + 1, uv = #{et.uv}, uip = #{et.uip}, update_time = #{et.updateTime};
    </insert>
</mapper>